# unbind C-b
# set -g prefix M-a
# bind M-a send-prefix

# Key bindings
bind-key x kill-pane
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R
unbind -T root \\
bind \\ split-window -h
bind - split-window -v -l 25% -c "#{pane_current_path}"

# Mouse and terminal
set -g mouse on
# set -g default-terminal "tmux-256color"
# set -ga terminal-overrides ",xterm-256color:Tc"
set-option -sa terminal-overrides ",xterm*:Tc"
set -as terminal-overrides ',*:Smulx=\E[4::%p1%dm'
set -as terminal-overrides ',*:Setulc=\E[58::2::%p1%{65536}%/%d::%p1%{256}%/%{255}%&%d::%p1%{255}%&%d%;m'

# Performance
set -s escape-time 10
set -sg repeat-time 600
set -s focus-events on

# Window/pane numbering
set -g base-index 1
setw -g pane-base-index 1
setw -g automatic-rename on
set -g renumber-windows on
set -g set-titles on

# Display times
set -g display-panes-time 800
set -g display-time 1000
set -g status-interval 1

# Activity
set -g monitor-activity on
set -g visual-activity off

# Status bar common settings
set -g status-position bottom
set -g status-justify left
set -g status-left ''
setw -g window-status-bell-style 'fg=#FFFBEF bg=#F85552 bold'
setw -g window-status-separator ''
set -g status-right-length 150

# vi mode
set-window-option -g mode-keys vi
bind-key v copy-mode
bind-key -T copy-mode-vi v send-keys -X begin-selection
bind-key -T copy-mode-vi C-v send-keys -X rectangle-toggle
bind-key -T copy-mode-vi y send-keys -X copy-selection-and-cancel

# Theme toggle binding
bind m run-shell "tmux set-environment TMUX_THEME \
  $([ \"$(tmux show-environment TMUX_THEME 2>/dev/null | cut -d= -f2)\" = \"dark\" ] && echo light || echo dark); \
  tmux source-file ~/.tmux.conf"

# Theme selection
if-shell '[ "$(tmux show-environment TMUX_THEME 2>/dev/null | cut -d= -f2)" = "dark" ]' {
  # Catppuccin Macchiato (dark)
  set -g pane-border-style 'fg=#5b6078'
  set -g pane-active-border-style 'fg=#8aadf4'

  set -g status-style 'fg=#cad3f5 bg=#24273a'
  set -g status-left ''
  set -g status-right '#[fg=#8aadf4,bg=#363a4f,bold] #{s/presentation-backend/pb/:#{s|/src/|/|:#{s|local_modules/||:@current_file}}} '

  setw -g window-status-format '#[fg=#6e738d,bg=#1e2030,bold] #I:#W ┃'
  setw -g window-status-current-format '#[fg=#24273a,bg=#8aadf4,bold] #I:#W '

  set-option -g display-panes-active-colour '#8aadf4'
  set-option -g message-style 'fg=#cad3f5 bg=#363a4f'
  #
  # VS Code Dark+ Theme
  # set -g pane-border-style 'fg=#3e3e42'
  # set -g pane-active-border-style 'fg=#007acc'
  #
  # set -g status-style 'fg=#cccccc bg=#373737'
  # set -g status-left ''
  # set -g status-right '#[fg=#007acc,bg=#373737,bold] #{s/presentation-backend/pb/:#{s|/src/|/|:#{s|local_modules/||:@current_file}}} '
  #
  # setw -g window-status-format '#[fg=#6a6a6a,bg=#181818,bold] #I:#W ┃'
  # setw -g window-status-current-format '#[fg=#ffffff,bg=#007acc,bold] #I:#W '
  #
  # set-option -g display-panes-active-colour '#007acc'
  # set-option -g message-style 'fg=#cccccc bg=#252526'
  
 # # OneDark Darker
 #  set -g pane-border-style 'fg=#535965'
 #  set -g pane-active-border-style 'fg=#bf68d9'
 #
 #  set -g status-style 'fg=#a0a8b7 bg=#282c34'
 #  set -g status-left ''
 #  set -g status-right '#[fg=#bf68d9,bg=#323641,bold] #{s/presentation-backend/pb/:#{s|/src/|/|:#{s|local_modules/||:@current_file}}} '
 #
 #  setw -g window-status-format '#[fg=#535965,bg=#1f2329,bold] #I:#W ┃'
 #  setw -g window-status-current-format '#[fg=#1f2329,bg=#8ebd6b,bold] #I:#W '
 #
 #  set-option -g display-panes-active-colour '#bf68d9'
 #  set-option -g message-style 'fg=#a0a8b7 bg=#323641'
} {
  # Light theme
  set-option -g display-panes-active-colour '#93B259'
  set-option -g message-style 'fg=#5C6A72 bg=#FEF2D5'
  set -g pane-border-style 'fg=#939F91'
  set -g pane-active-border-style 'fg=#93B259'
  
  set -g status-style 'fg=#5C6A72 bg=#EFEBD4'
  set -g status-left ''
  
  setw -g window-status-format '#[fg=#808080,bg=#f4f0D9,bold] #I:#W ┃'
  setw -g window-status-current-format '#[fg=#ffffff,bg=#93B259,bold] #I:#W '
  set -g status-right '#[fg=#829181,bg=#E6E2CC,bold] #{s/presentation-backend/pb/:#{s|/src/|/|:#{s|local_modules/||:@current_file}}} '
  
  set-option -g display-panes-active-colour '#93B259'
  set-option -g message-style 'fg=#5C6A72 bg=#FEF2D5'
}
